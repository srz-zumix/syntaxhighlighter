- name: ci
  service: syntaxhighlighter
  type: serial
  steps:
    - command: ls

- name: store key to id_rsa file and chmod file to r/w for user
  service: push
  command: /bin/bash -c "echo -e $PRIVATE_SSH_KEY >> ${HOME}/.ssh/id_rsa && chmod 600 ${HOME}/.ssh/id_rsa"

# https://help.github.com/articles/adding-a-new-ssh-key-to-your-github-account/
- name: confirm ssh connection to server, authenticating with generated public ssh key
  service: push
  command: /bin/bash -c "ssh -T git@github.com 2>&1 | grep 'successfully authenticated'"

- name: deploy
  service: push
  command: sh -c "curl -sSL https://raw.githubusercontent.com/codeship/scripts/master/deployments/git_push.sh | bash -s"

